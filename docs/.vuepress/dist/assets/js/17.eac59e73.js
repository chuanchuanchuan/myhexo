(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{73:function(t,s,n){"use strict";n.r(s);var e=n(0),a=Object(e.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("div",{staticClass:"language-python extra-class"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -*- coding: utf-8 -*-")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" pymongo "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MongoClient\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" io\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" traceback\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n"),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("reload")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setdefaultencoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MySQLdb\n\nconn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MySQLdb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lcc'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("passwd"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'chaochaoliu'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weibo_casc'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("charset"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8mb4'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncur"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("conn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cursor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nsql"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INSERT into cas values (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'")]),t._v("\n\n")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("client1 = MongoClient('localhost', 1234)\nclient2 = MongoClient('localhost', 2341)\nclient3 = MongoClient('localhost', 3412)\n#client4 = MongoClient('localhost', 4123)\nclient5 = MongoClient('localhost', 5123)\n#client6 = MongoClient('localhost', 6123)\n\ndb1 = client1.test\ndb2 = client2.test\ndb3 = client3.test\n#db4 = client4.test\ndb5 = client5.test\n#db6 = client6.test\n\nusers=db1.users\nblogs1 = db1.microblogs\nblogs2 = db2.microblogs\nblogs3 = db3.microblogs\n#blogs4 = db4.microblogs\nblogs5 = db5.microblogs\n#blogs6 = db6.microblogs\n#blogs=[blogs1,blogs2,blogs3,blogs4,blogs5,blogs6]\nblogs=[blogs1,blogs2,blogs3,blogs5]\n\nfor data in users.find():\n\ttry:\n\t\tuserid=data['id']\n\t\tcreate_time=data['created_at']\n\t\tlocation=data['location']\n\t\tfor b in blogs:\n\t\t\tparam=[]\n\t\t\ttry:\n\t\t\t\tfor weibo in b.find({\"user_id\":userid}):\n\t\t\t\t\ttry:\n\t\t\t\t\t\tid=weibo['_id']\n\t\t\t\t\t\ttext=weibo['text']\n\t\t\t\t\t\ttime=weibo['created_at']\n\t\t\t\t\t\tif weibo.has_key('retweeted_status'):\n\t\t\t\t\t\t\tret=\"1\"\n\t\t\t\t\t\t\tre_stat=weibo['retweeted_status']\n\t\t\t\t\t\t\tre_text=re_stat['text']\n\t\t\t\t\t\t\tre_time=re_stat['created_at']\n\t\t\t\t\t\t\tre_user=re_stat['user_id']\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tret=\"0\"\n\t\t\t\t\t\t\tre_text=\"\"\n\t\t\t\t\t\t\tre_time=\"\"\n\t\t\t\t\t\t\tre_user=\"\"\n\t\t\t\t\t\tparam.append([str(id),str(userid),str(text.encode(\"utf8\")),str(time),str(location.encode(\"utf8\")),str(create_time),str(re_text.encode(\"utf8\")),str(re_time),str(re_user),str(ret)])\n\t\t\t\t\texcept:\n\t\t\t\t\t\tcontinue\n\t\t\t\ttry:\n\t\t\t\t\tcur.executemany(sql,param)\n\t\t\t\t\tconn.commit()\n\t\t\t\texcept:\n\t\t\t\t\tcontinue\n\t\t\texcept:\n\t\t\t\tcontinue\n\texcept:\n\t\tcontinue\n\ncur.close()\nconn.close()\nclient1.close()\nclient2.close()\nclient3.close()\nclient4.close()\nclient5.close()\nclient6.close()\n\n\n")])])])])},[],!1,null,null,null);s.default=a.exports}}]);